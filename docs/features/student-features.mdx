# Student Features

## Overview

Students are the primary users of the Facility Management System. They can report facility issues, track progress, and provide feedback on resolutions. This guide covers all student-facing features and their implementation details.

---

## Feature Index
- [Authentication](#authentication)
- [Ticket Management](#ticket-management)
- [Comments & Communication](#comments--communication)
- [Ticket Status Tracking](#ticket-status-tracking)
- [History & Audit Trail](#history--audit-trail)
- [Email Notifications](#email-notifications)
- [Feedback System](#feedback-system)

---

## Authentication

### Description
Secure authentication system allowing students to access the facility management platform using their institutional credentials.

### Technical Implementation

**Endpoints:**
```
POST   /api/auth/register/          # Student registration
POST   /api/auth/login/             # Login with credentials
POST   /api/auth/logout/            # Invalidate JWT token
POST   /api/auth/refresh/           # Refresh access token
POST   /api/auth/password-reset/    # Request password reset
PUT    /api/auth/password-reset/confirm/  # Confirm new password
```

**Authentication Flow:**
```
1. Student submits credentials
2. Backend validates against database
3. JWT access + refresh tokens generated
4. Tokens stored securely (cookies or local storage)
5. Access token used for subsequent requests
6. Refresh token renews access token when expired
```

**Security Considerations:**
- Passwords hashed 
- JWT tokens with short expiration (1 hour for access, 7 days for refresh)
- Rate limiting on login attempts (max 5 per minute)
- HTTPS only in production

### Related Files

```
backend/apps/users/
├── models.py              # User model
├── serializers.py         # Auth serializers
├── views.py              # Auth views
└── tests/
    └── test_auth.py      # Auth test cases
```

## Ticket Management

### Description
Core CRUD operations allowing students to create, view, update, and delete facility issue tickets.

### Technical Implementation

**Endpoints:**
```
POST   /api/tickets/                # Create new ticket
GET    /api/tickets/                # List all my tickets
GET    /api/tickets/{id}/           # Get specific ticket
PUT    /api/tickets/{id}/           # Update ticket (if not in progress)
DELETE /api/tickets/{id}/           # Delete ticket (if pending)
```

**Business Rules:**
- Students can only edit tickets in "Pending" status
- Students can only delete tickets in "Pending" status
- Location is mandatory (dropdown or autocomplete)
- Title and description are required
- Initial priority defaults to "Medium" (admin can change)

### Related Files

```
backend/apps/tickets/
├── models.py              # Ticket model
├── serializers.py         # Ticket serializers
├── views.py              # Ticket viewsets
├── permissions.py        # Custom permissions
├── filters.py            # Filtering logic
└── tests/
    ├── test_models.py
    ├── test_views.py
    └── test_permissions.py
```

## File & Media Handling

### Description
System for uploading, storing, and retrieving photos and files attached to tickets. Helps maintenance teams visualize facility issues.

### Technical Implementation

**Endpoints:**
```
POST   /api/tickets/{id}/attachments/     # Upload file
GET    /api/tickets/{id}/attachments/     # List attachments
DELETE /api/tickets/{id}/attachments/{attachment_id}/  # Remove file
```

**Storage Strategy:**
- **Development:** Local filesystem (`media/tickets/`)
- **Production:** AWS S3 or DigitalOcean Spaces
- File naming: `{ticket_id}/{uuid}.{extension}`

**File Constraints:**
- Max file size: 5MB per file
- Max files per ticket: 5
- Allowed formats: JPEG, PNG, WebP, PDF
- Images auto-compressed to max 1920px width

**Security:**
- Validate file types (check magic bytes, not just extension)
- Scan for malware in production
- Signed URLs for private access
- CORS configured for your domain only

### Related Files

```
backend/apps/tickets/
├── models.py              # Attachment model
├── serializers.py         # File upload serializers
├── views.py              # Upload endpoints
├── utils.py              # File processing utilities
└── storage.py            # Custom storage backend

backend/config/
└── settings.py           # Media storage config
```

---

**Last Updated:** January 2026
**Maintained by:** The Square Thing
**Next Review:** February 2026